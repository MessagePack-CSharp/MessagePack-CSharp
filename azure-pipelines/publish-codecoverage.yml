parameters:
  includeMacOS:

steps:
- download: current
  artifact: coverageResults-Windows
  displayName: ðŸ”» Download Windows code coverage results
  continueOnError: true
- download: current
  artifact: coverageResults-Linux
  displayName: ðŸ”» Download Linux code coverage results
  continueOnError: true
- download: current
  artifact: coverageResults-macOS
  displayName: ðŸ”» Download macOS code coverage results
  continueOnError: true
  condition: and(succeeded(), ${{ parameters.includeMacOS }})
- powershell: azure-pipelines/Merge-CodeCoverage.ps1 -Path '$(Pipeline.Workspace)' -OutputFile coveragereport/merged.cobertura.xml -Format Cobertura -Verbose
  displayName: âš™ Merge coverage
- task: PublishCodeCoverageResults@2
  displayName: ðŸ“¢ Publish code coverage results to Azure DevOps
  inputs:
    summaryFileLocation: coveragereport/merged.cobertura.xml
    failIfCoverageEmpty: true
